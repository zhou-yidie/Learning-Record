# 布隆过滤器

## 标准布隆过滤器 (StandardBloomFilter)

### 数据结构
- 使用 `vector<bool>` 存储位数组。

### 哈希函数
- 通过组合两种哈希值生成多个不同的哈希位置。

### 自动计算参数
- 根据预期元素数量和可接受误判率自动计算最优大小和哈希函数数量。

### 操作复杂度
- 插入和查询均为 O(k)，其中 k 为哈希函数数量。

---

## 计数布隆过滤器 (CountingBloomFilter)

### 扩展功能
- 继承自标准布隆过滤器，并改用 `vector<uint8_t>` 存储计数器。

### 支持删除
- 通过减少计数器值实现删除操作（但需注意删除的安全性）。

### 溢出处理
- 计数器达到 255 时停止增加（8 位存储限制）。

---

## 动态扩容布隆过滤器 (ScalableBloomFilter)

### 分层结构
- 维护多个标准布隆过滤器实例。

### 自动扩容
- 当当前层接近饱和时，自动添加新层。

### 误判率控制
- 后续层使用更低的误判率参数。

### 查询优化
- 从最新层往旧层查询，提升热点数据访问速度。

---

## 扩展类型特性对比

| 类型                       | 特点                             | 适用场景                         |
|----------------------------|----------------------------------|----------------------------------|
| **标准布隆过滤器**           | 基础实现，内存效率高               | 只读缓存、URL检查               |
| **计数布隆过滤器**           | 支持删除操作                       | 需要动态更新的缓存系统         |
| **动态扩容布隆过滤器**       | 自动扩展容量，适应数据增长         | 数据量不可预知的流式处理系统   |

---

## 使用建议

- **标准布隆过滤器适用于：**
  - 静态数据集（如恶意网站黑名单）。
  - 需要极高内存效率的场景。

- **计数布隆过滤器适用于：**
  - 需要支持删除操作的动态系统。
  - 允许少量计数器溢出的场景。

- **动态扩容布隆过滤器适用于：**
  - 数据量持续增长的流式处理。
  - 无法预知最大数据量的应用场景。

---

## 代码说明

### 标准版特性
- 使用 `vector<bool>` 压缩存储。
- 通过数学公式自动计算最优参数。
- 双重哈希法生成多个独立哈希值。

### 计数版特性
- 使用 `vector<uint8_t>` 实现计数器。
- 支持删除操作（需注意计数器溢出）。
- 继承标准版的参数计算方法。

### 动态扩容版特性
- 分层存储结构 (`vector<FilterLayer>`)。
- 指数级容量增长（`growth_factor` 控制）。
- 误判率逐层递减（`fp_decay` 控制）。
- 自动触发扩容机制。
